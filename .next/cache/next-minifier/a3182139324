{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{0:function(e,t,n){n(\"GcxT\"),e.exports=n(\"nOHt\")},\"1TCz\":function(e,t,n){\"use strict\";n.r(t);var a=n(\"q1tI\"),r=n.n(a),s=(n(\"PAfn\"),n(\"0iUn\")),c=n(\"sLSF\"),o=n(\"MI3g\"),i=n(\"a7VT\"),u=n(\"AT/M\"),l=n(\"Tit0\"),d=n(\"vYYK\"),p=n(\"YFqc\"),h=n.n(p),m=n(\"96Je\"),f=n.n(m),g=n(\"ma3e\"),b=n(\"HbWr\"),O=r.a.createElement,S=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return n=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r))),Object(d.a)(Object(u.a)(n),\"state\",{isOpen:!1}),Object(d.a)(Object(u.a)(n),\"componentDidMount\",(function(){n.context.updateCredentials(!0)})),Object(d.a)(Object(u.a)(n),\"handleToggle\",(function(){n.setState({isOpen:!n.state.isOpen})})),Object(d.a)(Object(u.a)(n),\"adminPanel\",(function(){var e=n.context.authenticated;if(null!==e)return e?O(\"button\",{onClick:n.context.logOut},\"Log Out\"):O(h.a,{href:\"/chat/\"},O(\"a\",null,\"Log in\"))})),n}return Object(l.a)(t,e),Object(c.a)(t,[{key:\"render\",value:function(){return O(\"nav\",{className:\"navbar\"},O(\"div\",{className:\"nav-center\"},O(\"div\",{className:\"nav-header\"},O(h.a,{href:\"/\"},O(\"img\",{src:f.a,alt:\"logo\"})),O(\"button\",{type:\"button\",className:\"nav-btn\"},O(g.a,{className:\"nav-icon\",onClick:this.handleToggle}))),O(\"ul\",{className:this.state.isOpen?\"nav-links show-nav\":\"nav-links\"},O(\"li\",null,O(h.a,{href:\"/\"},O(\"a\",null,\"Home\"))),O(\"li\",null,O(h.a,{href:\"/rooms/\"},O(\"a\",null,\"Rooms\")))),O(\"div\",{className:\"admin-panel\"},O(h.a,{href:\"/chat/\"},O(g.g,null)),this.adminPanel())))}}]),t}(a.Component);Object(d.a)(S,\"contextType\",b.a);var v=n(\"9Jkg\"),j=n.n(v),y=r.a.createElement,x=function(e){function t(e){var n;return Object(s.a)(this,t),n=Object(o.a)(this,Object(i.a)(t).call(this,e)),Object(d.a)(Object(u.a)(n),\"handleChange\",(function(e){n.setState(Object(d.a)({},e.target.name,e.target.value))})),Object(d.a)(Object(u.a)(n),\"onSubmit\",(function(e){e.preventDefault(),n.props.onSubmit(n.state.username)})),n.state={username:\"\"},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:\"render\",value:function(){return y(r.a.Fragment,null,y(\"form\",{onSubmit:this.onSubmit,className:\"username-form\",autoComplete:\"off\"},y(\"label\",{htmlFor:\"username\"},\"Enter your name to start chat with an agent\"),y(\"input\",{name:\"username\",type:\"text\",placeholder:\"Nombre\",onChange:this.handleChange,value:this.state.username}),y(\"button\",{className:\"btn-primary\",type:\"submit\"},\"Enviar\")))}}]),t}(a.Component),T=n(\"dfwq\"),M=n(\"cm3u\"),w=n.n(M),U=r.a.createElement,I=function(e){function t(e){return Object(s.a)(this,t),Object(o.a)(this,Object(i.a)(t).call(this,e))}return Object(l.a)(t,e),Object(c.a)(t,[{key:\"render\",value:function(){var e=this;return U(\"ul\",{className:\"user-message-list\"},this.props.messages.map((function(t){var n=t.senderId,a=n.length,r=n.substring(20,a);return U(\"li\",{className:e.props.currentUser.id==t.senderId?\"admin-style\":\"customer-style\",key:t.id},U(\"div\",{className:\"chat-msg\"},U(\"div\",{className:\"avatar\"},e.props.currentUser.id==t.senderId?r[0]:n[0]),U(\"div\",{className:\"msg-content\"},U(\"span\",null,e.props.currentUser.id==t.senderId?r:n),U(\"p\",null,t.text))))})))}}]),t}(a.Component),C=n(\"NIcq\"),N=r.a.createElement,E=function(e){function t(e){var n;return Object(s.a)(this,t),n=Object(o.a)(this,Object(i.a)(t).call(this,e)),Object(d.a)(Object(u.a)(n),\"handleChange\",(function(e){n.setState(Object(d.a)({},e.target.name,e.target.value))})),Object(d.a)(Object(u.a)(n),\"onSubmit\",(function(e){e.preventDefault(),n.props.onSubmit(n.state.text),n.setState({text:\"\"})})),n.state={text:\"\"},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:\"render\",value:function(){return N(\"div\",{className:\"user-send-form\"},N(\"form\",{onSubmit:this.onSubmit,autoComplete:\"off\"},N(\"input\",{name:\"text\",type:\"text\",placeholder:\"Your text...\",onChange:this.handleChange,value:this.state.text}),N(\"div\",null,N(\"button\",{type:\"submit\"},N(C.c,null)))))}}]),t}(a.Component),k=r.a.createElement;function _(e){return k(\"div\",null,k(\"p\",null,e.userTyping,\" is typing...\"))}var F=r.a.createElement,R=function(e){function t(e){var n;return Object(s.a)(this,t),n=Object(o.a)(this,Object(i.a)(t).call(this,e)),Object(d.a)(Object(u.a)(n),\"componentDidMount\",(function(){new w.a.ChatManager({instanceLocator:\"v1:us1:fe088103-8b4d-4e06-a93c-4d2fb3f963be\",userId:n.props.userId,tokenProvider:new w.a.TokenProvider({url:\"https://express-login.now.sh/chat/authenticate\"})}).connect().then((function(e){return n.setState({currentUser:e}),console.log(e),e.createRoom({id:e.id,name:e.name,private:!0,addUserIds:[e.id,\"guido\"]}).then((function(t){return n.setState({currentRoom:t}),e.subscribeToRoom({roomId:t.id,messageLimit:100,hooks:{onMessage:function(e){console.log(e),n.setState({messages:[].concat(Object(T.a)(n.state.messages),[e])})},onUserStartedTyping:function(e){n.setState({userTyping:e.name,isUserTyping:!0})},onUserStoppedTyping:function(e){n.setState({userTyping:e.name,isUserTyping:!1})}}}).then((function(){return n.state.currentUser.subscribeToRoomMultipart({roomId:\"765b61eb-ad46-4c8b-bd31-2e4d4acc6f45\",messageLimit:100,hooks:{onPresenceChanged:function(e,t){console.log(\"User \".concat(t.name,\" is \").concat(e.current))}}}).catch((function(e){return console.log(e)}))}))})).catch((function(e){console.log(\"error\",e)}))})).catch((function(e){return console.log(\"Hiiiii\",e)}))})),Object(d.a)(Object(u.a)(n),\"sendMessage\",(function(e){n.state.currentUser.sendSimpleMessage({roomId:n.state.currentRoom.id,text:e}).then((function(e){return n.setState({text:\"\"})})).catch((function(e){return console.log(\"error\",e)}))})),Object(d.a)(Object(u.a)(n),\"sendTypingEvent\",(function(){n.state.currentUser.isTypingIn({roomId:n.state.currentRoom.id}).catch((function(e){console.log(e)}))})),n.state={messages:[],currentRoom:{},currentUser:{},userTyping:\"\",isUserTyping:!1},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:\"render\",value:function(){return F(\"div\",{className:\"chat-screen\"},F(I,{messages:this.state.messages,currentUser:this.state.currentUser}),this.state.isUserTyping?F(_,{userTyping:this.state.userTyping}):\"\",F(E,{onSubmit:this.sendMessage,onChange:this.sendTypingEvent}))}}]),t}(a.Component),D=r.a.createElement;function A(){return D(\"div\",{className:\"widget-header\"},D(\"h4\",null,\"My chat\"),D(\"h5\",null,\"Welcome!\"))}var P=r.a.createElement,Y=function(e){function t(e){var n;return Object(s.a)(this,t),n=Object(o.a)(this,Object(i.a)(t).call(this,e)),Object(d.a)(Object(u.a)(n),\"handleChat\",(function(){return\"WhatIsYourUsernameScreen\"===n.props.currentScreen?P(x,{onSubmit:n.props.onSubmit}):\"ChatScreen\"===n.props.currentScreen&&\"\"!==n.state.userId&&\"\"!==n.state.currentUsername?P(R,{currentUsername:n.state.currentUsername,userId:n.state.userId}):void 0})),n.state={userId:\"\",currentUsername:\"\"},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:\"componentDidUpdate\",value:function(e){e.userId!==this.props.userId&&e.currentUsername!==this.props.currentUsername&&(console.log(\"updated\",this.props),this.setState({userId:this.props.userId,currentUsername:this.props.currentUsername}))}},{key:\"render\",value:function(){return P(\"div\",{className:this.props.show?\"chat-screen-display\":\"chat-screen-display inactive\"},P(A,null),this.handleChat())}}]),t}(a.Component),H=n(\"vDqi\"),J=n.n(H),L=n(\"fDyJ\"),q=n.n(L),W=r.a.createElement,z=function(e){function t(e){var n;return Object(s.a)(this,t),n=Object(o.a)(this,Object(i.a)(t).call(this,e)),Object(d.a)(Object(u.a)(n),\"handleSubmit\",(function(e){var t=q.a.asString(new Date),a=t.slice(0,10),r=t.slice(11,19);J()({url:\"https://express-login.now.sh/chat/users\",method:\"POST\",data:j()({username:e,date:\"\".concat(a,\" \").concat(r)}),headers:{\"Content-Type\":\"application/json\"}}).then((function(t){console.log(t.data.userId),console.log(\"success\"),n.setState({currentUsername:e,currentScreen:\"ChatScreen\",userId:t.data.userId})})).catch((function(e){console.log(e)}))})),Object(d.a)(Object(u.a)(n),\"toggleModal\",(function(){n.setState({modalShow:!n.state.modalShow})})),n.state={currentScreen:\"WhatIsYourUsernameScreen\",currentUsername:\"\",userId:\"\",modalShow:!1},n}return Object(l.a)(t,e),Object(c.a)(t,[{key:\"render\",value:function(){return this.context.authenticated||null===this.context.authenticated?W(\"div\",null):W(\"div\",{className:\"chat-component chat-icon\"},W(\"div\",{className:\"chat-component-wrapper\"},W(Y,{show:this.state.modalShow,onSubmit:this.handleSubmit,currentScreen:this.state.currentScreen,currentUsername:this.state.currentUsername,userId:this.state.userId}),W(\"div\",{className:\"chat-icon-wrapper\",onClick:this.toggleModal},W(\"div\",{className:\"modal-icon\"},W(C.b,{className:this.state.modalShow?\"cross\":\"cross hide\"})),W(\"div\",{className:\"modal-icon\"},W(C.a,{className:this.state.modalShow?\"chat hide\":\"chat\"})))))}}]),t}(a.Component);Object(d.a)(z,\"contextType\",b.a),n.d(t,\"default\",(function(){return G}));var Z=r.a.createElement;function G(e){var t=e.Component,n=e.pageProps;return Z(r.a.Fragment,null,Z(b.b,null,Z(S,null),Z(t,n),Z(z,null)))}},\"96Je\":function(e,t){e.exports=\"/_next/static/images/logo-9f0cccc1e406a5aa9ef6ee36229762c3.svg\"},GcxT:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/_app\",function(){return n(\"1TCz\")}])},fDyJ:function(e,t,n){\"use strict\";function a(e,t){for(var n=e.toString();n.length<t;)n=\"0\"+n;return n}function r(e){return a(e,2)}function s(t,n){\"string\"!==typeof t&&(n=t,t=e.exports.ISO8601_FORMAT),n||(n=e.exports.now());var s=r(n.getDate()),c=r(n.getMonth()+1),o=r(n.getFullYear()),i=r(o.substring(2,4)),u=t.indexOf(\"yyyy\")>-1?o:i,l=r(n.getHours()),d=r(n.getMinutes()),p=r(n.getSeconds()),h=a(n.getMilliseconds(),3),m=function(e){var t=Math.abs(e),n=String(Math.floor(t/60)),a=String(t%60);return 1===n.length&&(n=\"0\"+n),1===a.length&&(a=\"0\"+a),e<0?\"+\"+n+a:\"-\"+n+a}(n.getTimezoneOffset());return t.replace(/dd/g,s).replace(/MM/g,c).replace(/y{1,4}/g,u).replace(/hh/g,l).replace(/mm/g,d).replace(/ss/g,p).replace(/SSS/g,h).replace(/O/g,m)}function c(e,t,n,a){e[\"set\"+(a?\"\":\"UTC\")+t](n)}e.exports=s,e.exports.asString=s,e.exports.parse=function(t,n,a){if(!t)throw new Error(\"pattern must be supplied\");return function(t,n,a){var r=t.indexOf(\"O\")<0,s=[{pattern:/y{1,4}/,regexp:\"\\\\d{1,4}\",fn:function(e,t){c(e,\"FullYear\",t,r)}},{pattern:/MM/,regexp:\"\\\\d{1,2}\",fn:function(e,t){c(e,\"Month\",t-1,r)}},{pattern:/dd/,regexp:\"\\\\d{1,2}\",fn:function(e,t){c(e,\"Date\",t,r)}},{pattern:/hh/,regexp:\"\\\\d{1,2}\",fn:function(e,t){c(e,\"Hours\",t,r)}},{pattern:/mm/,regexp:\"\\\\d\\\\d\",fn:function(e,t){c(e,\"Minutes\",t,r)}},{pattern:/ss/,regexp:\"\\\\d\\\\d\",fn:function(e,t){c(e,\"Seconds\",t,r)}},{pattern:/SSS/,regexp:\"\\\\d\\\\d\\\\d\",fn:function(e,t){c(e,\"Milliseconds\",t,r)}},{pattern:/O/,regexp:\"[+-]\\\\d{3,4}|Z\",fn:function(e,t){\"Z\"===t&&(t=0);var n=Math.abs(t),a=(t>0?-1:1)*(n%100+60*Math.floor(n/100));e.setUTCMinutes(e.getUTCMinutes()+a)}}],o=s.reduce((function(e,t){return t.pattern.test(e.regexp)?(t.index=e.regexp.match(t.pattern).index,e.regexp=e.regexp.replace(t.pattern,\"(\"+t.regexp+\")\")):t.index=-1,e}),{regexp:t,index:[]}),i=s.filter((function(e){return e.index>-1}));i.sort((function(e,t){return e.index-t.index}));var u=new RegExp(o.regexp).exec(n);if(u){var l=a||e.exports.now();return i.forEach((function(e,t){e.fn(l,u[t+1])})),l}throw new Error(\"String '\"+n+\"' could not be parsed as '\"+t+\"'\")}(t,n,a)},e.exports.now=function(){return new Date},e.exports.ISO8601_FORMAT=\"yyyy-MM-ddThh:mm:ss.SSS\",e.exports.ISO8601_WITH_TZ_OFFSET_FORMAT=\"yyyy-MM-ddThh:mm:ss.SSSO\",e.exports.DATETIME_FORMAT=\"dd MM yyyy hh:mm:ss.SSS\",e.exports.ABSOLUTETIME_FORMAT=\"hh:mm:ss.SSS\"}},[[0,1,2,4,6,0,3,5,16]]]);"}